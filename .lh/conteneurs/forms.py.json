{
    "sourceFile": "conteneurs/forms.py",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 18,
            "patches": [
                {
                    "date": 1734391140043,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1734391471866,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -235,9 +235,8 @@\n     can_delete=True\n )\n \n \n-\n class ConteneurAcconageForm(forms.ModelForm):\n \n     def __init__(self, *args, **kwargs):\n         super(ConteneurAcconageForm, self).__init__(*args, **kwargs)\n@@ -291,9 +290,99 @@\n         fields = [  'poids_net', 'poids_equipements', 'numero_heating_pad', 'photo_heating_pad', \n                   'numero_flexitank', 'photo_flexitank', 'numero_plomb', 'photo_plomb']\n \n \n+class IsoTankForm(forms.ModelForm):\n+    def __init__(self, *args, **kwargs):\n+        super(IsoTankForm, self).__init__(*args, **kwargs)\n+        self.helper = FormHelper()\n+        self.helper.layout = Layout(\n+            Row(\n+                Column('reference', css_class='form-group col-md-6 mb-0'),\n+                Column('etat', css_class='form-group col-md-6 mb-0'),\n+                css_class='form-row'\n+            ),\n+            Row(\n+                Column('photo_devant', css_class='form-group col-md-4 mb-0'),\n+                Column('photo_lateral_droit', css_class='form-group col-md-4 mb-0'),\n+                Column('photo_derriere', css_class='form-group col-md-4 mb-0'),\n+                css_class='form-row'\n+            ),\n+            Row(\n+                Column('photo_lateral_gauche', css_class='form-group col-md-6 mb-0'),\n+                Column('photo_interieur', css_class='form-group col-md-6 mb-0'),\n+                css_class='form-row'\n+            ),\n+            Submit('submit', 'Enregistrer')\n+        )\n \n+    class Meta:\n+        model = Conteneur\n+        fields = ['reference', 'etat', 'photo_devant', 'photo_derriere', 'photo_interieur','photo_lateral_droit','photo_lateral_gauche']\n+        \n+# Créez un FormSet pour le modèle Conteneur\n+ConteneurFormSet = modelformset_factory(\n+    IsoTanks,\n+    form=IsoTankForm,\n+    extra=1,  # Nombre de formulaires supplémentaires à afficher\n+    can_delete=True\n+)\n+\n+\n+\n+class IsoTankAcconageForm(forms.ModelForm):\n+\n+    def __init__(self, *args, **kwargs):\n+        super(IsoTankAcconageForm, self).__init__(*args, **kwargs)\n+        self.helper = FormHelper()\n+        self.helper.layout = Layout(\n+            # Poids brute et Poids équipements sur la même ligne\n+            Row(\n+                Column('poids_brute', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                css_class='form-row'\n+            ),\n+            # Poids net sur une ligne à part entière\n+            Row(\n+                Column('poids_net', css_class='form-group col-md-12 mb-0'),  # Pleine largeur\n+                css_class='form-row'\n+            ),\n+            # Numéro Plomb et Photo Plomb sur la même ligne\n+            Row(\n+                Column('numero_plomb1', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                Column('photo_plomb1', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                css_class='form-row'\n+            ),\n+            Row(\n+                Column('numero_plomb2', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                Column('photo_plomb2', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                css_class='form-row'\n+            ),\n+            Row(\n+                Column('numero_plomb3', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                Column('photo_plomb3', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                css_class='form-row'\n+            ),\n+            # Bouton de soumission\n+            Submit('submit', 'Enregistrer')\n+        )\n+\n+    def clean(self):\n+        cleaned_data = super().clean()\n+        poids_brute = cleaned_data.get('poids_brute')\n+        poids_net = cleaned_data.get('poids_net')\n+\n+        if poids_net and poids_brute and poids_net > poids_brute:\n+            raise forms.ValidationError(\"Le poids net ne peut pas être supérieur au poids brut.\")\n+\n+        return cleaned_data\n+\n+    class Meta:\n+        model = Conteneur\n+        fields = [  'poids_net', 'poids_equipements', 'numero_heating_pad', 'photo_heating_pad', \n+                  'numero_flexitank', 'photo_flexitank', 'numero_plomb', 'photo_plomb']\n+\n+\n+\n class Dossiers2Form(forms.ModelForm):\n     \n     def __init__(self, *args, **kwargs):\n         super(Dossiers2Form, self).__init__(*args, **kwargs)\n"
                },
                {
                    "date": 1734391904350,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -376,10 +376,9 @@\n         return cleaned_data\n \n     class Meta:\n         model = Conteneur\n-        fields = [  'poids_net', 'poids_equipements', 'numero_heating_pad', 'photo_heating_pad', \n-                  'numero_flexitank', 'photo_flexitank', 'numero_plomb', 'photo_plomb']\n+        fields = [  'poids_net', 'numero_plomb1', 'numero_plomb2', 'numero_plomb3', 'photo_plomb1', 'photo_plomb2', 'photo_plomb3']\n \n \n \n class Dossiers2Form(forms.ModelForm):\n"
                },
                {
                    "date": 1734392139204,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -315,9 +315,9 @@\n             Submit('submit', 'Enregistrer')\n         )\n \n     class Meta:\n-        model = Conteneur\n+        model = IsoTanks\n         fields = ['reference', 'etat', 'photo_devant', 'photo_derriere', 'photo_interieur','photo_lateral_droit','photo_lateral_gauche']\n         \n # Créez un FormSet pour le modèle Conteneur\n ConteneurFormSet = modelformset_factory(\n@@ -326,10 +326,8 @@\n     extra=1,  # Nombre de formulaires supplémentaires à afficher\n     can_delete=True\n )\n \n-\n-\n class IsoTankAcconageForm(forms.ModelForm):\n \n     def __init__(self, *args, **kwargs):\n         super(IsoTankAcconageForm, self).__init__(*args, **kwargs)\n@@ -375,9 +373,9 @@\n \n         return cleaned_data\n \n     class Meta:\n-        model = Conteneur\n+        model = IsoTanks\n         fields = [  'poids_net', 'numero_plomb1', 'numero_plomb2', 'numero_plomb3', 'photo_plomb1', 'photo_plomb2', 'photo_plomb3']\n \n \n \n"
                },
                {
                    "date": 1734426666890,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -326,12 +326,12 @@\n     extra=1,  # Nombre de formulaires supplémentaires à afficher\n     can_delete=True\n )\n \n-class IsoTankAcconageForm(forms.ModelForm):\n+class ConteneurISO20Form(forms.ModelForm):\n \n     def __init__(self, *args, **kwargs):\n-        super(IsoTankAcconageForm, self).__init__(*args, **kwargs)\n+        super(ConteneurISO20Form, self).__init__(*args, **kwargs)\n         self.helper = FormHelper()\n         self.helper.layout = Layout(\n             # Poids brute et Poids équipements sur la même ligne\n             Row(\n@@ -342,24 +342,9 @@\n             Row(\n                 Column('poids_net', css_class='form-group col-md-12 mb-0'),  # Pleine largeur\n                 css_class='form-row'\n             ),\n-            # Numéro Plomb et Photo Plomb sur la même ligne\n-            Row(\n-                Column('numero_plomb1', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n-                Column('photo_plomb1', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n-                css_class='form-row'\n-            ),\n-            Row(\n-                Column('numero_plomb2', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n-                Column('photo_plomb2', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n-                css_class='form-row'\n-            ),\n-            Row(\n-                Column('numero_plomb3', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n-                Column('photo_plomb3', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n-                css_class='form-row'\n-            ),\n+            \n             # Bouton de soumission\n             Submit('submit', 'Enregistrer')\n         )\n \n@@ -373,10 +358,10 @@\n \n         return cleaned_data\n \n     class Meta:\n-        model = IsoTanks\n-        fields = [  'poids_net', 'numero_plomb1', 'numero_plomb2', 'numero_plomb3', 'photo_plomb1', 'photo_plomb2', 'photo_plomb3']\n+        model = Conteneur\n+        fields = [  'poids_net']\n \n \n \n class Dossiers2Form(forms.ModelForm):\n"
                },
                {
                    "date": 1734434117199,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -287,47 +287,11 @@\n \n     class Meta:\n         model = Conteneur\n         fields = [  'poids_net', 'poids_equipements', 'numero_heating_pad', 'photo_heating_pad', \n-                  'numero_flexitank', 'photo_flexitank', 'numero_plomb', 'photo_plomb']\n+                'numero_flexitank', 'photo_flexitank', 'numero_plomb', 'photo_plomb']\n \n \n-class IsoTankForm(forms.ModelForm):\n-    def __init__(self, *args, **kwargs):\n-        super(IsoTankForm, self).__init__(*args, **kwargs)\n-        self.helper = FormHelper()\n-        self.helper.layout = Layout(\n-            Row(\n-                Column('reference', css_class='form-group col-md-6 mb-0'),\n-                Column('etat', css_class='form-group col-md-6 mb-0'),\n-                css_class='form-row'\n-            ),\n-            Row(\n-                Column('photo_devant', css_class='form-group col-md-4 mb-0'),\n-                Column('photo_lateral_droit', css_class='form-group col-md-4 mb-0'),\n-                Column('photo_derriere', css_class='form-group col-md-4 mb-0'),\n-                css_class='form-row'\n-            ),\n-            Row(\n-                Column('photo_lateral_gauche', css_class='form-group col-md-6 mb-0'),\n-                Column('photo_interieur', css_class='form-group col-md-6 mb-0'),\n-                css_class='form-row'\n-            ),\n-            Submit('submit', 'Enregistrer')\n-        )\n-\n-    class Meta:\n-        model = IsoTanks\n-        fields = ['reference', 'etat', 'photo_devant', 'photo_derriere', 'photo_interieur','photo_lateral_droit','photo_lateral_gauche']\n-        \n-# Créez un FormSet pour le modèle Conteneur\n-ConteneurFormSet = modelformset_factory(\n-    IsoTanks,\n-    form=IsoTankForm,\n-    extra=1,  # Nombre de formulaires supplémentaires à afficher\n-    can_delete=True\n-)\n-\n class ConteneurISO20Form(forms.ModelForm):\n \n     def __init__(self, *args, **kwargs):\n         super(ConteneurISO20Form, self).__init__(*args, **kwargs)\n"
                },
                {
                    "date": 1734434753519,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -314,9 +314,9 @@\n \n     def clean(self):\n         cleaned_data = super().clean()\n         poids_brute = cleaned_data.get('poids_brute')\n-        poids_net = cleaned_data.get('poids_net')\n+        poids_net = cleaned_data.get('poids_net',)\n \n         if poids_net and poids_brute and poids_net > poids_brute:\n             raise forms.ValidationError(\"Le poids net ne peut pas être supérieur au poids brut.\")\n \n"
                },
                {
                    "date": 1734434791087,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,9 +306,12 @@\n             Row(\n                 Column('poids_net', css_class='form-group col-md-12 mb-0'),  # Pleine largeur\n                 css_class='form-row'\n             ),\n-            \n+            Row(\n+                Column('poids_net', css_class='form-group col-md-12 mb-0'),  # Pleine largeur\n+                css_class='form-row'\n+            ),\n             # Bouton de soumission\n             Submit('submit', 'Enregistrer')\n         )\n \n"
                },
                {
                    "date": 1734434816065,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -307,9 +307,9 @@\n                 Column('poids_net', css_class='form-group col-md-12 mb-0'),  # Pleine largeur\n                 css_class='form-row'\n             ),\n             Row(\n-                Column('poids_net', css_class='form-group col-md-12 mb-0'),  # Pleine largeur\n+                Column('numero_plomb', css_class='form-group col-md-12 mb-0'),  # Pleine largeur\n                 css_class='form-row'\n             ),\n             # Bouton de soumission\n             Submit('submit', 'Enregistrer')\n"
                },
                {
                    "date": 1734434831219,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -326,9 +326,9 @@\n         return cleaned_data\n \n     class Meta:\n         model = Conteneur\n-        fields = [  'poids_net']\n+        fields = [  'poids_net','numero_plomb']\n \n \n \n class Dossiers2Form(forms.ModelForm):\n"
                },
                {
                    "date": 1734434884909,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,10 +306,11 @@\n             Row(\n                 Column('poids_net', css_class='form-group col-md-12 mb-0'),  # Pleine largeur\n                 css_class='form-row'\n             ),\n-            Row(\n-                Column('numero_plomb', css_class='form-group col-md-12 mb-0'),  # Pleine largeur\n+               Row(\n+                Column('numero_plomb', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                Column('photo_plomb', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                 css_class='form-row'\n             ),\n             # Bouton de soumission\n             Submit('submit', 'Enregistrer')\n@@ -326,9 +327,9 @@\n         return cleaned_data\n \n     class Meta:\n         model = Conteneur\n-        fields = [  'poids_net','numero_plomb']\n+        fields = [  'poids_net','numero_plomb','photo_plomb']\n \n \n \n class Dossiers2Form(forms.ModelForm):\n"
                },
                {
                    "date": 1734434930669,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -311,8 +311,13 @@\n                 Column('numero_plomb', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                 Column('photo_plomb', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                 css_class='form-row'\n             ),\n+                Row(\n+                Column('numero_plomb2', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                Column('photo_plomb2', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                css_class='form-row'\n+            ),\n             # Bouton de soumission\n             Submit('submit', 'Enregistrer')\n         )\n \n"
                },
                {
                    "date": 1734434949927,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -316,8 +316,13 @@\n                 Column('numero_plomb2', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                 Column('photo_plomb2', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                 css_class='form-row'\n             ),\n+                Row(\n+                Column('numero_plomb3', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                Column('photo_plomb3', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n+                css_class='form-row'\n+            ),\n             # Bouton de soumission\n             Submit('submit', 'Enregistrer')\n         )\n \n"
                },
                {
                    "date": 1734434976879,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -337,9 +337,9 @@\n         return cleaned_data\n \n     class Meta:\n         model = Conteneur\n-        fields = [  'poids_net','numero_plomb','photo_plomb']\n+        fields = [  'poids_net','numero_plomb','photo_plomb','numero_plomb2','photo_plomb2','numero_plomb3','photo_plomb3']\n \n \n \n class Dossiers2Form(forms.ModelForm):\n"
                },
                {
                    "date": 1734435867818,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -287,9 +287,9 @@\n \n     class Meta:\n         model = Conteneur\n         fields = [  'poids_net', 'poids_equipements', 'numero_heating_pad', 'photo_heating_pad', \n-                'numero_flexitank', 'photo_flexitank', 'numero_plomb', 'photo_plomb']\n+                'numero_flexitank', 'photo_flexitank', 'numero_plomb', 'photo_plomb','numero_plomb2','photo_plomb2','numero_plomb3','photo_plomb3']\n \n \n class ConteneurISO20Form(forms.ModelForm):\n \n"
                },
                {
                    "date": 1734435926651,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -287,9 +287,9 @@\n \n     class Meta:\n         model = Conteneur\n         fields = [  'poids_net', 'poids_equipements', 'numero_heating_pad', 'photo_heating_pad', \n-                'numero_flexitank', 'photo_flexitank', 'numero_plomb', 'photo_plomb','numero_plomb2','photo_plomb2','numero_plomb3','photo_plomb3']\n+                'numero_flexitank', 'photo_flexitank', 'numero_plomb', 'photo_plomb']\n \n \n class ConteneurISO20Form(forms.ModelForm):\n \n"
                },
                {
                    "date": 1734625372486,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -195,9 +195,35 @@\n     class Meta:\n         model=Dossier\n         fields = ['projet', 'TRD', 'booking', 'type_conteneur', 'client', 'commodite', 'port_de_chargement', 'port_de_dechargement', 'compagnie_maritime', 'site', 'agent_selection', 'agent_acconage','Site_empotage']\n        \n-     \n+class DossiersNigeriaForm(forms.ModelForm):\n+    \n+    \"\"\"\n+    Formulaire pour la création et la modification des dossiers.\n+    \"\"\"\n+    \n+    def __init__(self, *args, **kwargs):\n+        super(DossiersNigeriaForm, self).__init__(*args, **kwargs)\n+        self.helper = FormHelper()\n+        self.helper.add_input(Submit('submit', 'Enregistrer'))\n+        self.fields['compagnie_maritime'].queryset = CompagnieMaritime.objects.filter(pays__nom='Gabon')\n+        self.fields['client'].queryset = Client.objects.filter(pays__nom='Gabon')\n+        self.fields['port_de_chargement'].queryset = POL.objects.filter(pays__nom='Gabon')\n+        self.fields['commodite'].queryset = Commodite.objects.filter(pays__nom='Gabon')\n+        self.fields['port_de_dechargement'].queryset = POD.objects.filter(pays__nom='Gabon')\n+        self.fields['site'].queryset = Site.objects.filter(pays__nom='Gabon')\n+        self.fields['Site_empotage'].queryset = Site_empotage.objects.filter(pays__nom='Gabon')\n+        self.fields['agent_selection'].queryset = Personnel.objects.filter(Personnel_pays='Gabon',Personnel_type='agent_selection')\n+        self.fields['agent_acconage'].queryset = Personnel.objects.filter(Personnel_pays='Gabon',Personnel_type='agent_acconage')\n+        self.initial['pays'] = Pays.objects.get(nom='Gabon')\n+        \n+       \n+    class Meta:\n+        model=Dossier\n+        fields = ['projet', 'TRD', 'booking', 'type_conteneur', 'client', 'commodite', 'port_de_chargement', 'port_de_dechargement', 'compagnie_maritime', 'site', 'agent_selection', 'agent_acconage','Site_empotage']\n+       \n+       \n \n \n class ConteneurForm(forms.ModelForm):\n     def __init__(self, *args, **kwargs):\n"
                },
                {
                    "date": 1734625677681,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -205,18 +205,18 @@\n     def __init__(self, *args, **kwargs):\n         super(DossiersNigeriaForm, self).__init__(*args, **kwargs)\n         self.helper = FormHelper()\n         self.helper.add_input(Submit('submit', 'Enregistrer'))\n-        self.fields['compagnie_maritime'].queryset = CompagnieMaritime.objects.filter(pays__nom='Gabon')\n-        self.fields['client'].queryset = Client.objects.filter(pays__nom='Gabon')\n-        self.fields['port_de_chargement'].queryset = POL.objects.filter(pays__nom='Gabon')\n-        self.fields['commodite'].queryset = Commodite.objects.filter(pays__nom='Gabon')\n-        self.fields['port_de_dechargement'].queryset = POD.objects.filter(pays__nom='Gabon')\n-        self.fields['site'].queryset = Site.objects.filter(pays__nom='Gabon')\n-        self.fields['Site_empotage'].queryset = Site_empotage.objects.filter(pays__nom='Gabon')\n-        self.fields['agent_selection'].queryset = Personnel.objects.filter(Personnel_pays='Gabon',Personnel_type='agent_selection')\n-        self.fields['agent_acconage'].queryset = Personnel.objects.filter(Personnel_pays='Gabon',Personnel_type='agent_acconage')\n-        self.initial['pays'] = Pays.objects.get(nom='Gabon')\n+        self.fields['compagnie_maritime'].queryset = CompagnieMaritime.objects.filter(pays__nom='Nigeria')\n+        self.fields['client'].queryset = Client.objects.filter(pays__nom='Nigeria')\n+        self.fields['port_de_chargement'].queryset = POL.objects.filter(pays__nom='Nigeria')\n+        self.fields['commodite'].queryset = Commodite.objects.filter(pays__nom='Nigeria')\n+        self.fields['port_de_dechargement'].queryset = POD.objects.filter(pays__nom='Nigeria')\n+        self.fields['site'].queryset = Site.objects.filter(pays__nom='Nigeria')\n+        self.fields['Site_empotage'].queryset = Site_empotage.objects.filter(pays__nom='Nigeria')\n+        self.fields['agent_selection'].queryset = Personnel.objects.filter(Personnel_pays='Nigeria',Personnel_type='agent_selection')\n+        self.fields['agent_acconage'].queryset = Personnel.objects.filter(Personnel_pays='Nigeria',Personnel_type='agent_acconage')\n+        self.initial['pays'] = Pays.objects.get(nom='Nigeria')\n         \n        \n     class Meta:\n         model=Dossier\n"
                },
                {
                    "date": 1734626557611,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -216,16 +216,15 @@\n         self.fields['agent_selection'].queryset = Personnel.objects.filter(Personnel_pays='Nigeria',Personnel_type='agent_selection')\n         self.fields['agent_acconage'].queryset = Personnel.objects.filter(Personnel_pays='Nigeria',Personnel_type='agent_acconage')\n         self.initial['pays'] = Pays.objects.get(nom='Nigeria')\n         \n-       \n+\n     class Meta:\n         model=Dossier\n         fields = ['projet', 'TRD', 'booking', 'type_conteneur', 'client', 'commodite', 'port_de_chargement', 'port_de_dechargement', 'compagnie_maritime', 'site', 'agent_selection', 'agent_acconage','Site_empotage']\n-       \n-       \n \n \n+\n class ConteneurForm(forms.ModelForm):\n     def __init__(self, *args, **kwargs):\n         super(ConteneurForm, self).__init__(*args, **kwargs)\n         self.helper = FormHelper()\n"
                }
            ],
            "date": 1734391140043,
            "name": "Commit-0",
            "content": "import random\nfrom django.core.exceptions import ValidationError\nfrom crispy_forms.helper import FormHelper\nfrom crispy_forms.layout import Layout, Row,Column\nfrom django.core.mail import send_mail\nfrom crispy_forms.helper import FormHelper\nfrom crispy_forms.layout import Submit\nfrom django.contrib.auth.forms import UserCreationForm, AuthenticationForm\nfrom django.forms import modelformset_factory\nfrom django import forms\n\nfrom .models import *\nfrom django.forms import  DateTimeInput\n\n#formulaire de connexion\nclass LoginForm(AuthenticationForm): \n    \n    username = forms.CharField(\n        max_length=254,\n        widget=forms.TextInput(attrs={'class': 'form-control', 'placeholder': 'Nom d\\'utilisateur ou e-mail', 'id': 'username'})\n    )\n    password = forms.CharField(\n        label=\"Mot de passe\",\n        widget=forms.PasswordInput(attrs={'class': 'form-control', 'placeholder': 'Mot de passe', 'id': 'password'})\n    )\n\n#formualaire de verification\nclass VerificationForm(forms.Form):\n \n    code = forms.CharField(max_length=6)\n    \n\n\n#formualire de creation de compte \nclass  PersonnelForm(UserCreationForm):\n    class Meta:\n        model = Personnel\n        fields = ('first_name','last_name','photos', 'email','Contact','username','Personnel_type','password1', 'password2')\n        \n    def clean_email(self):\n        email = self.cleaned_data.get('email')\n        if Personnel.objects.filter(email=email).exists():\n            raise ValidationError(\"Un compte avec cet e-mail existe déjà.\")\n        return email\n    \n    def save(self, commit=True):\n        user = super().save(commit=False)\n        user.is_active = False  # Désactiver le compte jusqu'à la vérification\n        if commit:\n            user.save()\n            code = str(random.randint(100000, 999999))\n            VerificationCode.objects.create(user=user, code=code)\n            send_mail(\n                'Votre code de vérification',\n                f'Votre code de vérification est {code}',\n                'kaboremessi@gmail.com',\n                [user.email],\n                fail_silently=False,\n            )\n        return user\n    \n# form de site \nclass SiteForm(forms.ModelForm):\n    def __init__(self, *args, **kwargs):\n        super(SiteForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n    \n    class Meta:\n        model=Site\n        fields='__all__'\n        labels={'nom_site':'Nom du Site '}\n\n\n# form de site \nclass SiteempotageForm(forms.ModelForm):\n    def __init__(self, *args, **kwargs):\n        super(SiteempotageForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n    \n    class Meta:\n        model=Site_empotage\n        fields='__all__'\n        labels={'nom_site':'Nom du Site '}\n\n# form de commodite\nclass CommoditeForm(forms.ModelForm):\n    def __init__(self, *args, **kwargs):\n        super(CommoditeForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n    class Meta :\n        model=Commodite\n        fields='__all__'\n\n#orm de Port De Dechargement \nclass PODForm(forms.ModelForm):\n    \n    def __init__(self, *args, **kwargs):\n        super(PODForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n    class Meta:\n        model=POD\n        fields='__all__'\n        labels={'nom_POD':'Nom du Port de Dechagement'}\n\n\n\nclass POLForm(forms.ModelForm):\n    \n    def __init__(self, *args, **kwargs):\n        super(POLForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n    class Meta:\n        model=POL\n        fields='__all__'\n        labels={'nom_POL':'Nom du Port de chagement'}\n        \n        \nclass CompagnieMaritimeForm(forms.ModelForm):\n    \n    def __init__(self, *args, **kwargs):\n        super(CompagnieMaritimeForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n    class Meta:\n        model=CompagnieMaritime\n        fields='__all__'\n        \n\n\n\nclass ClientForm(forms.ModelForm):\n    \n    def __init__(self, *args, **kwargs):\n        super(ClientForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n    class Meta:\n        model=Client\n        fields='__all__'\n        \n\nclass DossiersForm(forms.ModelForm):\n    \n    \"\"\"\n    Formulaire pour la création et la modification des dossiers.\n    \"\"\"\n    \n    def __init__(self, *args, **kwargs):\n        super(DossiersForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n        self.fields['compagnie_maritime'].queryset = CompagnieMaritime.objects.filter(pays__nom='Côte d\\'Ivoire')\n        self.fields['client'].queryset = Client.objects.filter(pays__nom='Côte d\\'Ivoire')\n        self.fields['port_de_chargement'].queryset = POL.objects.filter(pays__nom='Côte d\\'Ivoire')\n        self.fields['commodite'].queryset = Commodite.objects.filter(pays__nom='Côte d\\'Ivoire')\n        self.fields['port_de_dechargement'].queryset = POD.objects.filter(pays__nom='Côte d\\'Ivoire')\n        self.fields['site'].queryset = Site.objects.filter(pays__nom='Côte d\\'Ivoire')\n        self.fields['Site_empotage'].queryset = Site_empotage.objects.filter(pays__nom='Côte d\\'Ivoire')\n        self.fields['agent_selection'].queryset = Personnel.objects.filter(Personnel_pays='côte_ivoire',Personnel_type='agent_selection')\n        self.fields['agent_acconage'].queryset = Personnel.objects.filter(Personnel_pays='côte_ivoire',Personnel_type='agent_acconage')\n        \n       \n    class Meta:\n        model=Dossier\n        fields = ['projet', 'TRD', 'booking', 'type_conteneur', 'client', 'commodite', 'port_de_chargement', 'port_de_dechargement', 'compagnie_maritime', 'site', 'agent_selection', 'agent_acconage','Site_empotage']\n       \n\nclass DossiersGabonForm(forms.ModelForm):\n    \n    \"\"\"\n    Formulaire pour la création et la modification des dossiers.\n    \"\"\"\n    \n    def __init__(self, *args, **kwargs):\n        super(DossiersGabonForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n        self.fields['compagnie_maritime'].queryset = CompagnieMaritime.objects.filter(pays__nom='Gabon')\n        self.fields['client'].queryset = Client.objects.filter(pays__nom='Gabon')\n        self.fields['port_de_chargement'].queryset = POL.objects.filter(pays__nom='Gabon')\n        self.fields['commodite'].queryset = Commodite.objects.filter(pays__nom='Gabon')\n        self.fields['port_de_dechargement'].queryset = POD.objects.filter(pays__nom='Gabon')\n        self.fields['site'].queryset = Site.objects.filter(pays__nom='Gabon')\n        self.fields['Site_empotage'].queryset = Site_empotage.objects.filter(pays__nom='Gabon')\n        self.fields['agent_selection'].queryset = Personnel.objects.filter(Personnel_pays='Gabon',Personnel_type='agent_selection')\n        self.fields['agent_acconage'].queryset = Personnel.objects.filter(Personnel_pays='Gabon',Personnel_type='agent_acconage')\n        self.initial['pays'] = Pays.objects.get(nom='Gabon')\n        \n       \n    class Meta:\n        model=Dossier\n        fields = ['projet', 'TRD', 'booking', 'type_conteneur', 'client', 'commodite', 'port_de_chargement', 'port_de_dechargement', 'compagnie_maritime', 'site', 'agent_selection', 'agent_acconage','Site_empotage']\n       \n     \n\n\nclass ConteneurForm(forms.ModelForm):\n    def __init__(self, *args, **kwargs):\n        super(ConteneurForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.layout = Layout(\n            Row(\n                Column('reference', css_class='form-group col-md-6 mb-0'),\n                Column('etat', css_class='form-group col-md-6 mb-0'),\n                css_class='form-row'\n            ),\n            Row(\n                Column('photo_devant', css_class='form-group col-md-4 mb-0'),\n                Column('photo_lateral_droit', css_class='form-group col-md-4 mb-0'),\n                Column('photo_derriere', css_class='form-group col-md-4 mb-0'),\n                css_class='form-row'\n            ),\n            Row(\n                Column('photo_lateral_gauche', css_class='form-group col-md-6 mb-0'),\n                Column('photo_interieur', css_class='form-group col-md-6 mb-0'),\n                css_class='form-row'\n            ),\n            Submit('submit', 'Enregistrer')\n        )\n\n    class Meta:\n        model = Conteneur\n        fields = ['reference', 'etat', 'photo_devant', 'photo_derriere', 'photo_interieur','photo_lateral_droit','photo_lateral_gauche']\n        \n# Créez un FormSet pour le modèle Conteneur\nConteneurFormSet = modelformset_factory(\n    Conteneur,\n    form=ConteneurForm,\n    extra=1,  # Nombre de formulaires supplémentaires à afficher\n    can_delete=True\n)\n\n\n\nclass ConteneurAcconageForm(forms.ModelForm):\n\n    def __init__(self, *args, **kwargs):\n        super(ConteneurAcconageForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.layout = Layout(\n            # Poids brute et Poids équipements sur la même ligne\n            Row(\n                Column('poids_brute', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                Column('poids_equipements', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                css_class='form-row'\n            ),\n            # Poids net sur une ligne à part entière\n            Row(\n                Column('poids_net', css_class='form-group col-md-12 mb-0'),  # Pleine largeur\n                css_class='form-row'\n            ),\n            # Numéro Heating Pad et Photo Heating Pad sur la même ligne\n            Row(\n                Column('numero_heating_pad', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                Column('photo_heating_pad', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                css_class='form-row'\n            ),\n            # Numéro Flexitank et Photo Flexitank sur la même ligne\n            Row(\n                Column('numero_flexitank', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                Column('photo_flexitank', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                css_class='form-row'\n            ),\n            # Numéro Plomb et Photo Plomb sur la même ligne\n            Row(\n                Column('numero_plomb', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                Column('photo_plomb', css_class='form-group col-md-6 mb-0'),  # 50% de la largeur\n                css_class='form-row'\n            ),\n            # Bouton de soumission\n            Submit('submit', 'Enregistrer')\n        )\n\n    def clean(self):\n        cleaned_data = super().clean()\n        poids_brute = cleaned_data.get('poids_brute')\n        poids_net = cleaned_data.get('poids_net')\n\n        if poids_net and poids_brute and poids_net > poids_brute:\n            raise forms.ValidationError(\"Le poids net ne peut pas être supérieur au poids brut.\")\n\n        return cleaned_data\n\n    class Meta:\n        model = Conteneur\n        fields = [  'poids_net', 'poids_equipements', 'numero_heating_pad', 'photo_heating_pad', \n                  'numero_flexitank', 'photo_flexitank', 'numero_plomb', 'photo_plomb']\n\n\n\nclass Dossiers2Form(forms.ModelForm):\n    \n    def __init__(self, *args, **kwargs):\n        super(Dossiers2Form, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n       \n    class Meta:\n        model=Dossier2\n        fields = ['projet', 'TRD', 'booking', 'type_conteneur', 'client', 'commodite', 'port_de_chargement', 'port_de_dechargement', 'compagnie_maritime', 'site', 'agent_selection', 'agent_acconage','Site_empotage','date_creation']\n       \n     \n\n \nclass AgentForm(forms.ModelForm):\n    \n    def __init__(self, *args, **kwargs):\n        super(AgentForm, self).__init__(*args, **kwargs)\n        self.helper = FormHelper()\n        self.helper.add_input(Submit('submit', 'Enregistrer'))\n    class Meta:\n        model=Agent\n        fields='__all__'\n        \n\n\nclass DocumentFactureForm(forms.ModelForm):\n    class Meta:\n        model = Document_Facture\n        fields = ['document']\n        \n\nclass AutreDocumentForm(forms.ModelForm):\n    class Meta:\n        model = AutreDocument\n        fields = ['document']\n        \n        \nclass ImagesForm(forms.ModelForm):\n    class Meta:\n        model = Images\n        fields = ['image']\n       "
        }
    ]
}